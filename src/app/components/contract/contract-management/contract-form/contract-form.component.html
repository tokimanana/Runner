<div class="contract-form">
  <h2>{{ getFormTitle() }}</h2>

  <form [formGroup]="contractForm" (ngSubmit)="onSubmit()">
    <mat-tab-group>
      <!-- Basic Details Tab -->
      <mat-tab label="Basic Details">
        <div class="tab-content">
          <!-- Contract Name -->
          <mat-form-field appearance="outline">
            <mat-label>Contract Name</mat-label>
            <input matInput formControlName="name" required>
            <mat-error *ngIf="contractForm.get('name')?.hasError('required')">
              Contract name is required
            </mat-error>
          </mat-form-field>

          <!-- Hotel Selection -->
          <mat-form-field appearance="outline">
            <mat-label>Hotel</mat-label>
            <mat-select formControlName="hotelId" required [compareWith]="compareById">
              <mat-option *ngFor="let hotel of hotels" [value]="hotel.id">
                {{ hotel.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="contractForm.get('hotelId')?.hasError('required')">
              Hotel is required
            </mat-error>
          </mat-form-field>

          <!-- Market Selection -->
          <mat-form-field appearance="outline">
            <mat-label>Market</mat-label>
            <mat-select formControlName="marketId" required [compareWith]="compareById">
              <mat-option *ngFor="let market of markets" [value]="market.id">
                {{ market.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="contractForm.get('marketId')?.hasError('required')">
              Market is required
            </mat-error>
          </mat-form-field>

          <!-- Season Selection -->
          <mat-form-field appearance="outline">
            <mat-label>Season</mat-label>
            <mat-select formControlName="seasonId" required [compareWith]="compareById">
              <mat-option *ngFor="let season of seasons" [value]="season.id">
                {{ season.name }}
              </mat-option>
            </mat-select>
            <mat-error *ngIf="contractForm.get('seasonId')?.hasError('required')">
              Season is required
            </mat-error>
          </mat-form-field>

          <!-- Room Types Selection -->
          <mat-form-field appearance="outline">
            <mat-label>Room Types</mat-label>
            <mat-select formControlName="selectedRooms" multiple required>
              <mat-option *ngFor="let room of roomTypes" [value]="room.id">
                {{ room.name }} ({{ room.category }})
              </mat-option>
            </mat-select>
            <mat-error *ngIf="contractForm.get('selectedRooms')?.hasError('required')">
              At least one room type must be selected
            </mat-error>
          </mat-form-field>

          <!-- Meal Plans Selection -->
          <mat-form-field appearance="outline">
            <mat-label>Meal Plans</mat-label>
            <mat-select formControlName="selectedMealPlans" multiple required>
              <mat-option *ngFor="let plan of mealPlans" [value]="plan.id">
                {{ plan.name }} ({{ plan.type }})
              </mat-option>
            </mat-select>
            <mat-error *ngIf="contractForm.get('selectedMealPlans')?.hasError('required')">
              At least one meal plan must be selected
            </mat-error>
          </mat-form-field>

          <!-- Validity Period -->
          <div class="date-range">
            <mat-form-field appearance="outline">
              <mat-label>Valid From</mat-label>
              <input matInput [matDatepicker]="validFromPicker" formControlName="validFrom" required>
              <mat-datepicker-toggle matSuffix [for]="validFromPicker"></mat-datepicker-toggle>
              <mat-datepicker #validFromPicker></mat-datepicker>
              <mat-error *ngIf="contractForm.get('validFrom')?.hasError('required')">
                Start date is required
              </mat-error>
            </mat-form-field>

            <mat-form-field appearance="outline">
              <mat-label>Valid To</mat-label>
              <input matInput [matDatepicker]="validToPicker" formControlName="validTo" required>
              <mat-datepicker-toggle matSuffix [for]="validToPicker"></mat-datepicker-toggle>
              <mat-datepicker #validToPicker></mat-datepicker>
              <mat-error *ngIf="contractForm.get('validTo')?.hasError('required')">
                End date is required
              </mat-error>
            </mat-form-field>
          </div>
        </div>
      </mat-tab>

      <!-- Terms & Conditions Tab -->
      <mat-tab label="Terms & Conditions">
        <div class="tab-content">
          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Terms & Conditions</mat-label>
            <textarea matInput formControlName="terms" rows="10"></textarea>
          </mat-form-field>

          <mat-form-field appearance="fill" class="full-width">
            <mat-label>Notes</mat-label>
            <textarea matInput formControlName="notes" rows="5"></textarea>
          </mat-form-field>
        </div>
      </mat-tab>
    </mat-tab-group>

    <!-- Form Actions -->
    <div class="form-actions">
      <button mat-button type="button" (click)="onCancel()">Cancel</button>
      <button mat-raised-button color="primary" type="submit" [disabled]="!contractForm.valid">
        {{ getSubmitButtonText() }} Contract
      </button>
    </div>
  </form>
</div>
